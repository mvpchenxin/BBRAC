var Web3 = require('web3');

if(typeof web3 !=='undefined'){ //检查是否已有web3实例
    web3=new Web3(web3.currentProvider);
}else{
    //否则就连接到给出节点
    web3=new Web3();
    web3.setProvider(new Web3.providers.WebsocketProvider("ws://localhost:23001"));
};

var pcAbi = [
	{
		"inputs": [],
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_resource",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_action",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_duty",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_algorithm",
				"type": "string"
			}
		],
		"name": "addPolicy",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_resource",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_action",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_sa",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_oa",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_ea",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_result",
				"type": "string"
			}
		],
		"name": "addRule",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_resource",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_action",
				"type": "string"
			}
		],
		"name": "deletePolicy",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_resource",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_action",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_sa",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_oa",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_ea",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_result",
				"type": "string"
			}
		],
		"name": "deleteRule",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_resource",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_action",
				"type": "string"
			}
		],
		"name": "getPolicy",
		"outputs": [
			{
				"internalType": "string",
				"name": "_duty",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_algorithm",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_resource",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_action",
				"type": "string"
			},
			{
				"internalType": "uint256",
				"name": "_index",
				"type": "uint256"
			}
		],
		"name": "getRule",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_resource",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "_action",
				"type": "string"
			}
		],
		"name": "getRuleNum",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "owner",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	}
];

var PC = new web3.eth.Contract(pcAbi);


PC.options.data = "0x608060405234801561001057600080fd5b5060008054600160a060020a03191633179055611c1b806100326000396000f3fe608060405234801561001057600080fd5b50600436106100a5576000357c010000000000000000000000000000000000000000000000000000000090048063575b65c611610078578063575b65c61461010f5780638da5cb5b14610132578063b80ff07114610147578063fb89f2931461015a576100a5565b80630d36ca03146100aa5780632e06aac6146100bf578063364cf66a146100e957806353073730146100fc575b600080fd5b6100bd6100b83660046115c7565b61017a565b005b6100d26100cd3660046114be565b6106f8565b6040516100e0929190611788565b60405180910390f35b6100bd6100f73660046115c7565b6108f4565b6100bd61010a36600461151f565b610a15565b61012261011d3660046116b5565b610ba5565b6040516100e094939291906117b6565b61013a611025565b6040516100e09190611767565b6100bd6101553660046114be565b611041565b61016d6101683660046114be565b61114d565b6040516100e09190611bb0565b60005473ffffffffffffffffffffffffffffffffffffffff1633146101bd5760405160e560020a62461bcd0281526004016101b4906118c8565b60405180910390fd5b6001866040516101cd919061174b565b9081526020016040518091039020856040516101e9919061174b565b9081526040519081900360200190206002015461021b5760405160e560020a62461bcd0281526004016101b49061180e565b60005b60018760405161022e919061174b565b90815260200160405180910390208660405161024a919061174b565b908152604051908190036020019020600201548110156106ef576060600188604051610276919061174b565b908152602001604051809103902087604051610292919061174b565b908152602001604051809103902060020182815481106102ae57fe5b6000918252602091829020600490910201805460408051601f60026000196101006001871615020190941693909304928301859004850281018501909152818152928301828280156103415780601f1061031657610100808354040283529160200191610341565b820191906000526020600020905b81548152906001019060200180831161032457829003601f168201915b50505050509050606060018960405161035a919061174b565b908152602001604051809103902088604051610376919061174b565b9081526020016040518091039020600201838154811061039257fe5b90600052602060002090600402016001018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156104375780601f1061040c57610100808354040283529160200191610437565b820191906000526020600020905b81548152906001019060200180831161041a57829003601f168201915b50505050509050606060018a604051610450919061174b565b90815260200160405180910390208960405161046c919061174b565b9081526020016040518091039020600201848154811061048857fe5b600091825260209182902060026004909202018101805460408051601f6000196101006001861615020190931694909404918201859004850284018501905280835291929091908301828280156105205780601f106104f557610100808354040283529160200191610520565b820191906000526020600020905b81548152906001019060200180831161050357829003601f168201915b50505050509050606060018b604051610539919061174b565b90815260200160405180910390208a604051610555919061174b565b9081526020016040518091039020600201858154811061057157fe5b6000918252602091829020600360049092020101805460408051601f60026000196101006001871615020190941693909304928301859004850281018501909152818152928301828280156106075780601f106105dc57610100808354040283529160200191610607565b820191906000526020600020905b8154815290600101906020018083116105ea57829003601f168201915b50505050509050610618848a6111f5565b8015610629575061062983896111f5565b801561063a575061063a82886111f5565b801561064b575061064b81876111f5565b156106df5760018b604051610660919061174b565b90815260200160405180910390208a60405161067c919061174b565b9081526020016040518091039020600201858154811061069857fe5b600091825260208220600490910201906106b282826112fe565b6106c06001830160006112fe565b6106ce6002830160006112fe565b6106dc6003830160006112fe565b50505b50506001909201915061021e9050565b50505050505050565b60608060018460405161070b919061174b565b908152602001604051809103902083604051610727919061174b565b9081526040519081900360200190205460ff166107595760405160e560020a62461bcd0281526004016101b490611b2d565b600184604051610769919061174b565b908152602001604051809103902083604051610785919061174b565b90815260200160405180910390206001016001856040516107a6919061174b565b9081526020016040518091039020846040516107c2919061174b565b9081526040805160209281900383018120845460026001821615610100026000190190911604601f810185900485028301850190935282825260030192909184918301828280156108545780601f1061082957610100808354040283529160200191610854565b820191906000526020600020905b81548152906001019060200180831161083757829003601f168201915b5050845460408051602060026001851615610100026000190190941693909304601f8101849004840282018401909252818152959750869450925084019050828280156108e25780601f106108b7576101008083540402835291602001916108e2565b820191906000526020600020905b8154815290600101906020018083116108c557829003601f168201915b50505050509050915091509250929050565b60005473ffffffffffffffffffffffffffffffffffffffff16331461092e5760405160e560020a62461bcd0281526004016101b49061186b565b60018660405161093e919061174b565b90815260200160405180910390208560405161095a919061174b565b908152604080516020928190038301812060808201835287825283820187905291810185905260608101849052600290910180546001810182556000918252908390208251805193946004909302909101926109b99284920190611345565b5060208281015180516109d29260018501920190611345565b50604082015180516109ee916002840191602090910190611345565b5060608201518051610a0a916003840191602090910190611345565b505050505050505050565b60005473ffffffffffffffffffffffffffffffffffffffff163314610a4f5760405160e560020a62461bcd0281526004016101b490611925565b600184604051610a5f919061174b565b908152602001604051809103902083604051610a7b919061174b565b9081526040519081900360200190205460ff1615610aae5760405160e560020a62461bcd0281526004016101b4906119df565b81600185604051610abf919061174b565b908152602001604051809103902084604051610adb919061174b565b90815260200160405180910390206001019080519060200190610aff929190611345565b5080600185604051610b11919061174b565b908152602001604051809103902084604051610b2d919061174b565b90815260200160405180910390206003019080519060200190610b51929190611345565b5060018085604051610b63919061174b565b908152602001604051809103902084604051610b7f919061174b565b908152604051908190036020019020805491151560ff1990921691909117905550505050565b606080606080600187604051610bbb919061174b565b908152602001604051809103902086604051610bd7919061174b565b90815260405190819003602001902060020154610c095760405160e560020a62461bcd0281526004016101b490611a3c565b600187604051610c19919061174b565b908152602001604051809103902086604051610c35919061174b565b90815260405190819003602001902060020154851115610c6a5760405160e560020a62461bcd0281526004016101b490611a99565b600187604051610c7a919061174b565b908152602001604051809103902086604051610c96919061174b565b90815260200160405180910390206002018581548110610cb257fe5b9060005260206000209060040201600001600188604051610cd3919061174b565b908152602001604051809103902087604051610cef919061174b565b90815260200160405180910390206002018681548110610d0b57fe5b9060005260206000209060040201600101600189604051610d2c919061174b565b908152602001604051809103902088604051610d48919061174b565b90815260200160405180910390206002018781548110610d6457fe5b906000526020600020906004020160020160018a604051610d85919061174b565b908152602001604051809103902089604051610da1919061174b565b90815260200160405180910390206002018881548110610dbd57fe5b9060005260206000209060040201600301838054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610e635780601f10610e3857610100808354040283529160200191610e63565b820191906000526020600020905b815481529060010190602001808311610e4657829003601f168201915b5050865460408051602060026001851615610100026000190190941693909304601f810184900484028201840190925281815295995088945092508401905082828015610ef15780601f10610ec657610100808354040283529160200191610ef1565b820191906000526020600020905b815481529060010190602001808311610ed457829003601f168201915b5050855460408051602060026001851615610100026000190190941693909304601f810184900484028201840190925281815295985087945092508401905082828015610f7f5780601f10610f5457610100808354040283529160200191610f7f565b820191906000526020600020905b815481529060010190602001808311610f6257829003601f168201915b5050845460408051602060026001851615610100026000190190941693909304601f81018490048402820184019092528181529597508694509250840190508282801561100d5780601f10610fe25761010080835404028352916020019161100d565b820191906000526020600020905b815481529060010190602001808311610ff057829003601f168201915b50505050509050935093509350935093509350935093565b60005473ffffffffffffffffffffffffffffffffffffffff1681565b60005473ffffffffffffffffffffffffffffffffffffffff16331461107b5760405160e560020a62461bcd0281526004016101b490611982565b60018260405161108b919061174b565b9081526020016040518091039020816040516110a7919061174b565b9081526040519081900360200190205460ff166110d95760405160e560020a62461bcd0281526004016101b490611ad0565b6001826040516110e9919061174b565b908152602001604051809103902081604051611105919061174b565b908152604051908190036020019020805460ff19168155600061112b60018301826112fe565b6111396002830160006113c3565b6111476003830160006112fe565b50505050565b600060018360405161115f919061174b565b90815260200160405180910390208260405161117b919061174b565b908152604051908190036020019020600201546111ad5760405160e560020a62461bcd0281526004016101b490611a3c565b6001836040516111bd919061174b565b9081526020016040518091039020826040516111d9919061174b565b9081526040519081900360200190206002015490505b92915050565b805182516000918491849114611210576000925050506111ef565b8151600114156112a6578060008151811061122757fe5b602001015160f860020a900460f860020a027effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168260008151811061126857fe5b602001015160f860020a900460f860020a027effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614925050506111ef565b836040516020016112b7919061174b565b60405160208183030381529060405280519060200120856040516020016112de919061174b565b6040516020818303038152906040528051906020012014925050506111ef565b50805460018160011615610100020316600290046000825580601f106113245750611342565b601f01602090049060005260206000209081019061134291906113e4565b50565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061138657805160ff19168380011785556113b3565b828001600101855582156113b3579182015b828111156113b3578251825591602001919060010190611398565b506113bf9291506113e4565b5090565b508054600082556004029060005260206000209081019061134291906113f9565b5b808211156113bf57600081556001016113e5565b808211156113bf57600061140d82826112fe565b61141b6001830160006112fe565b6114296002830160006112fe565b6114376003830160006112fe565b506004016113f9565b600082601f830112611450578081fd5b813567ffffffffffffffff80821115611467578283fd5b604051601f8301601f191681016020018281118282101715611487578485fd5b6040528281529250828483016020018610156114a257600080fd5b8260208601602083013760006020848301015250505092915050565b600080604083850312156114d0578182fd5b823567ffffffffffffffff808211156114e7578384fd5b6114f386838701611440565b93506020850135915080821115611508578283fd5b5061151585828601611440565b9150509250929050565b60008060008060808587031215611534578182fd5b843567ffffffffffffffff8082111561154b578384fd5b61155788838901611440565b9550602087013591508082111561156c578384fd5b61157888838901611440565b9450604087013591508082111561158d578384fd5b61159988838901611440565b935060608701359150808211156115ae578283fd5b506115bb87828801611440565b91505092959194509250565b60008060008060008060c087890312156115df578182fd5b863567ffffffffffffffff808211156115f6578384fd5b6116028a838b01611440565b97506020890135915080821115611617578384fd5b6116238a838b01611440565b96506040890135915080821115611638578384fd5b6116448a838b01611440565b95506060890135915080821115611659578384fd5b6116658a838b01611440565b9450608089013591508082111561167a578384fd5b6116868a838b01611440565b935060a089013591508082111561169b578283fd5b506116a889828a01611440565b9150509295509295509295565b6000806000606084860312156116c9578283fd5b833567ffffffffffffffff808211156116e0578485fd5b6116ec87838801611440565b94506020860135915080821115611701578384fd5b5061170e86828701611440565b925050604084013590509250925092565b60008151808452611737816020860160208601611bb9565b601f01601f19169290920160200192915050565b6000825161175d818460208701611bb9565b9190910192915050565b73ffffffffffffffffffffffffffffffffffffffff91909116815260200190565b60006040825261179b604083018561171f565b82810360208401526117ad818561171f565b95945050505050565b6000608082526117c9608083018761171f565b82810360208401526117db818761171f565b905082810360408401526117ef818661171f565b90508281036060840152611803818561171f565b979650505050505050565b60208082526024908201527f64656c65746552756c65206572726f723a2072756c65206c697374206973206e60408201527f756c6c2100000000000000000000000000000000000000000000000000000000606082015260800190565b6020808252602c908201527f61646452756c65206572726f723a2043616c6c6572206973206e6f7420636f6e60408201527f7472616374206f776e6572210000000000000000000000000000000000000000606082015260800190565b60208082526026908201527f64656c65746552756c65206572726f723a2043616c6c6572206973206e6f742060408201527f6f776e6572210000000000000000000000000000000000000000000000000000606082015260800190565b6020808252602e908201527f616464506f6c696379206572726f723a2043616c6c6572206973206e6f74206360408201527f6f6e7472616374206f776e657221000000000000000000000000000000000000606082015260800190565b60208082526031908201527f64656c657465506f6c696379206572726f723a2043616c6c6572206973206e6f60408201527f7420636f6e7472616374206f776e657221000000000000000000000000000000606082015260800190565b60208082526026908201527f616464506f6c696379206572726f723a20706f6c69637920616c72656164792060408201527f6578697374210000000000000000000000000000000000000000000000000000606082015260800190565b60208082526022908201527f67657452756c65206572726f723a2072756c6573206c697374206973206e756c60408201527f6c21000000000000000000000000000000000000000000000000000000000000606082015260800190565b6020808252601e908201527f67657452756c65206572726f723a205f696e646578206f757472616765210000604082015260600190565b60208082526025908201527f64656c657465504f6c696379206572726f723a20706f6c696379206e6f74206560408201527f7869737421000000000000000000000000000000000000000000000000000000606082015260800190565b6020808252604e908201527f676574506f6c696379206572726f723a205468657265206973206e6f20706f6c60408201527f69637920666f722074686973207265736f7572636520616e6420616374696f6e60608201527f20617420746869732074696d6521000000000000000000000000000000000000608082015260a00190565b90815260200190565b60005b83811015611bd4578181015183820152602001611bbc565b83811115611147575050600091015256fea2646970667358221220280a2a94c58cc33df5cdd2a185b6c0aa1aedbfbcb957d33058ebccc456c4265364736f6c63430007000033"

PC.deploy().send({
    from: '0xb474edb969802f81e5bb0c977bee3b0ab91736f8',
    gas: 6000000,
    gasPrice: '0'
})
.then(function(newContractInstance){
    //console.log(newContractInstance.options.address) // instance with the new contract address
    process.exit(0);
});



